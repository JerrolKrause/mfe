<form [formGroup]="controlForm">
  <!--
  <div class="float-end">
    <button>Update Customer Screen</button>
  </div>
  <div>
    <p>Customer Loan Preferences</p>
    <p>Loan Amount, Cash Out, Monthly Payment, Term. Debt Record to pay off.</p>
  </div>
  -->

  @for(product of controls;track product) {
  <div class="control">
    <div class="d-flex mb-3" style="justify-content: space-between">
      <h3 class="mb-0">{{ product.label }}</h3>
      <div>
        <button
          class="p-button small"
          [ngClass]="
            !!controlForm?.get(product.prop + '.allowRange')?.value
              ? ''
              : ' p-button-outlined'
          "
          (click)="
            controlForm
              ?.get(product.prop + '.allowRange')
              ?.patchValue(
                !controlForm?.get(product.prop + '.allowRange')?.value
              )
          "
        >
          Enable Range
        </button>
      </div>
    </div>
    <div class="mb-3">
      <div class="mb-3" formGroupName="userSelection">
        @if(!!controlForm.get(product.prop + '.allowRange')?.value){
        <p-slider
          [min]="controlForm.get(product.prop + '.minValue')?.value ?? 0"
          [max]="controlForm.get(product.prop + '.maxValue')?.value ?? 0"
          [step]="1000"
          [range]="true"
          [formControlName]="product.rangeProp"
        ></p-slider>
        } @else {
        <p-slider
          [min]="controlForm.get(product.prop + '.minValue')?.value ?? 0"
          [max]="controlForm.get(product.prop + '.maxValue')?.value ?? 0"
          [step]="1000"
          [formControlName]="product.prop"
        ></p-slider>
        }
      </div>
      <div
        class="d-flex"
        style="justify-content: space-between"
        [formGroupName]="product.prop"
      >
        <p-inputNumber
          inputId="integeronly"
          [size]="10"
          currency="USD"
          locale="en-US"
          formControlName="minValue"
          [min]="500"
        >
        </p-inputNumber>

        @if(!!controlForm.get(product.prop + '.allowRange')?.value){
        <div class="selected-value range">
          {{
            controlForm.get('userSelection.' + product.rangeProp + '.0')?.value
              | currency : 'USD' : 'symbol' : '1.0-2'
          }}

          -
          {{
            controlForm.get('userSelection.' + product.rangeProp + '.1')?.value
              | currency : 'USD' : 'symbol' : '1.0-2'
          }}
        </div>
        } @else {
        <div class="selected-value">
          {{
            controlForm.get('userSelection.' + product.prop)?.value
              | currency : 'USD' : 'symbol' : '1.0-2'
          }}
        </div>
        }

        <p-inputNumber
          inputId="integeronly"
          [size]="10"
          [max]="25000"
          currency="USD"
          locale="en-US"
          formControlName="maxValue"
        >
        </p-inputNumber>
      </div>
    </div>
    <hr />
  </div>
  }

  <!--
  <p class="mb-0">Select Available Creditors</p>
  <table class="table table-sm table-striped table-hover">
    <tbody>
      @for(creditor of creditors;track creditor.label; let index = $index) {
      <tr class="clickable">
        <td>
          <p-checkbox [binary]="true"></p-checkbox>
        </td>
        <td>{{ creditor.label }}</td>
        <td>${{ creditor.totalOwed }}</td>
        <td>${{ creditor.monthlyPayment }}</td>
      </tr>
      }
    </tbody>
  </table>
  -->
</form>
